(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7183:(e,t,a)=>{Promise.resolve().then(a.bind(a,4137))},4137:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>V});var s=a(5155),r=a(2115),l=a(719),n=a.n(l),c=a(4367);let i=a(2651).A.create({baseURL:"https://itunes.apple.com",timeout:5e3,headers:{"Content-Type":"application/json"},withCredentials:!0}),m={search:async(e,t)=>{try{return(await i.get("/search",{params:{term:e,limit:t}})).data.results}catch(e){throw Error("Search error")}},searchItem:async e=>{try{return(await i.get("/lookup",{params:{id:e}})).data.results}catch(e){throw Error("Search error")}}};var o=a(3972),x=function(e){return e.PRIMARY="md:px-10 bg-gradient-to-l from-pink-500 via-rose-400 to-orange-500 text-white",e.SECONDARY="bg-gray-600 text-white/90 capitalize",e}({});let d=e=>{let{buttonType:t,text:a,onClick:r,className:l}=e;return(0,s.jsx)(o.T,{className:"".concat(t," ").concat(l),onPress:r,disableAnimation:!0,children:a})};var u=a(2779),h=a(191),p=a(7892);let j=e=>e.reduce((e,t)=>{let a=e.get(t.wrapperType)||[];return a.push(t),e.set(t.wrapperType,a),e},new Map),N=e=>"track"===e.wrapperType&&"trackId"in e?{title:e.trackName,subtitle:e.artistName,price:e.trackPrice,date:e.releaseDate,imageUrl:e.artworkUrl100,link:e.collectionViewUrl||""}:"audiobook"===e.wrapperType&&"artistId"in e?{title:e.artistName,subtitle:e.collectionName,price:e.collectionPrice,date:e.releaseDate,imageUrl:e.artworkUrl100,link:e.collectionViewUrl||""}:{title:e.artistName,date:e.releaseDate,imageUrl:e.artworkUrl100},f=e=>void 0!==e.trackId,g=e=>{let t=new Date(e),a=new Intl.DateTimeFormat("en-US",{day:"numeric",month:"long",year:"numeric"});return t?a.format(t):null},y=e=>{let{items:t,onInputChange:a,isLoading:r,placeholder:l,startContent:n,ref:c,onEnter:i,label:m,onSelect:o}=e;return(0,s.jsx)(u.H,{items:t,label:m,placeholder:l,isLoading:r,startContent:n,isClearable:!0,classNames:{selectorButton:"hidden",listbox:"h-fit space-y-10"},inputProps:{classNames:{innerWrapper:"px-2"}},onInputChange:a,allowsCustomValue:!0,ref:c,onKeyDown:e=>{i&&"Enter"===e.key&&i(!0)},"aria-label":"autocomplete",onSelectionChange:o,children:t.map((e,t)=>(0,s.jsx)(h.y,{textValue:f(e)?e.trackName:e.collectionName,classNames:{base:"h-fit"},children:(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(p.Q,{alt:e.artistName,className:"flex-shrink-0",size:"sm",src:e.artworkUrl100}),(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("h5",{className:"text-small text-neutral-950",children:f(e)?e.trackName:e.collectionName}),(0,s.jsx)("p",{className:"text-tiny text-default-400",children:e.artistName})]})]})},t))})},w=e=>{let{setItems:t,setIsLoading:a}=e,[l,i]=(0,r.useState)([]),o=(0,r.useRef)(null),u=n()(async e=>{e.trim()?i(await m.search(e,10)):i([])},1e3),h=async e=>{try{a(!0);let s=await m.search(e).finally(()=>a(!1));t(s)}catch(e){console.error("Search failed:",e)}},p=async e=>{if(null===e||!l[Number(e)])return;let a=j(l[Number(e)]);a&&t(await m.searchItem(a))},j=e=>f(e)?e.trackId||null:e.collectionId||null;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y,{items:l,startContent:(0,s.jsx)(c.Mmj,{className:"w-6 h-6 text-black"}),onInputChange:u,ref:o,onEnter:()=>{o.current&&h(o.current.value)},onSelect:p}),(0,s.jsx)(d,{buttonType:x.PRIMARY,text:"Search",onClick:()=>{o.current&&h(o.current.value)}})]})},b=()=>(0,s.jsx)("div",{className:"py-24 text-white text-center",children:(0,s.jsx)("h2",{className:"text-xl font-medium",children:"Not found"})});var k=a(5565),v=a(8173),C=a.n(v);let U=e=>{let{item:t}=e;return(0,s.jsxs)("div",{className:"my-10 flex gap-2 sm:gap-4",children:[(0,s.jsx)("div",{className:"w-full max-w-40 aspect-square relative",children:(0,s.jsx)(k.default,{alt:"Card background",className:"object-contain rounded-xl",src:t.artworkUrl100,fill:!0,loading:"lazy"})}),(0,s.jsxs)("div",{className:"flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl text-neutral-100",children:f(t)?t.trackCensoredName:t.collectionName}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-neutral-400",children:t.artistName})]}),(0,s.jsx)(C(),{href:t.collectionViewUrl,className:"text-sm sm:text-base",children:"Перейти"})]})]})},I=e=>{let{groups:t,currentGroup:a,onGroupSelect:r}=e;return(0,s.jsx)("div",{className:"py-3 flex flex-wrap gap-4",children:t.map((e,t)=>(0,s.jsx)(d,{buttonType:x.SECONDARY,text:e,onClick:()=>r(e),className:"px-8 ".concat(a===e?"bg-white text-black":"")},"wrapper_type_item-".concat(t)))})};var S=a(7293),E=a(3767),_=a(4908);let T=e=>{let{title:t,subtitle:a,price:r,date:l,imageUrl:n,link:c}=e;return(0,s.jsx)(S.Z,{className:"bg-transparent hover:bg-white/10",children:(0,s.jsxs)(E.U,{className:"grid grid-cols-[100px_1fr] sm:grid-cols-[1fr_6fr_2fr] gap-2 sm:gap-4",children:[(0,s.jsx)("div",{className:"w-full aspect-square relative",children:(0,s.jsx)(k.default,{alt:"Card background",className:"object-contain rounded-xl",src:n,fill:!0,loading:"lazy"})}),(0,s.jsxs)("div",{className:"flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-md sm:text-xl text-neutral-100",children:t}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-neutral-400",children:a})]}),c&&(0,s.jsxs)(C(),{href:c,className:"text-sm sm:text-base",children:["Перейти ",(0,s.jsx)(_.Edn,{className:"inline"})]})]}),(0,s.jsxs)("div",{className:"max-sm:col-span-2 flex flex-row-reverse sm:flex-col items-baseline sm:items-end justify-start gap-6 md:justify-between",children:[(0,s.jsx)("div",{className:"mt-2 w-fit h-fit px-4 py-1 border border-neutral-200 rounded-md",children:(0,s.jsxs)("p",{children:[r?"".concat(r," $"):"free"," "]})}),l&&(0,s.jsx)("p",{className:"text-sm text-neutral-400",children:g(l)})]})]})})},D=e=>{let{item:t}=e,{title:a,subtitle:r,price:l,date:n,imageUrl:c,link:i}=N(t);return(0,s.jsx)(T,{title:a,subtitle:r,price:l,date:n,imageUrl:c,link:i})},R=e=>{let{items:t}=e;return t&&0!==t.length?(0,s.jsx)("div",{className:"space-y-2 sm:space-y-4",children:t.map((e,t)=>(0,s.jsx)(D,{item:e},t))}):null},A=e=>{let{items:t}=e,[a,l]=(0,r.useState)(null),n=(0,r.useMemo)(()=>j(t),[t]);console.log("groupedMap: ",[...n.keys()]),(0,r.useEffect)(()=>{l(Array.from(n.keys())[0])},[n]);let c=a&&n.get(a)||[];return(0,s.jsxs)("section",{className:"my-4",children:[(0,s.jsx)(I,{groups:[...n.keys()],currentGroup:a,onGroupSelect:e=>{l(e)}}),(0,s.jsx)(R,{items:c})]})},P=e=>{let{items:t}=e;return t?0===t.length?(0,s.jsx)(b,{}):1===t.length?(0,s.jsx)(U,{item:t[0]}):(0,s.jsx)(A,{items:t}):void 0};var M=a(1503);let z=()=>(0,s.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,s.jsx)(M.o,{size:"lg"})});function V(){let[e,t]=(0,r.useState)(null),[a,l]=(0,r.useState)(!0);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w,{setItems:t,setIsLoading:l}),a?(0,s.jsx)(z,{}):(0,s.jsx)(P,{items:e})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[206,760,376,441,517,358],()=>t(7183)),_N_E=e.O()}]);